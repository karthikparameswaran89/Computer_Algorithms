import msal
import requests

TENANT_ID = "<your-tenant-id>"
CLIENT_ID = "<your-client-id>"
CLIENT_SECRET = "<your-client-secret>"
DATABRICKS_RESOURCE = "2ff814a6-3304-4ab8-85cb-cd0e6f879c1d"

authority = f"https://login.microsoftonline.com/{TENANT_ID}"
app = msal.ConfidentialClientApplication(
    client_id=CLIENT_ID,
    client_credential=CLIENT_SECRET,
    authority=authority
)

token_response = app.acquire_token_for_client(scopes=[f"{DATABRICKS_RESOURCE}/.default"])

access_token = token_response["access_token"]

headers = {"Authorization": f"Bearer {access_token}"}
response = requests.get("https://<databricks-instance>/api/2.0/clusters/list", headers=headers)

print(response.json())
